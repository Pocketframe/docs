"use strict";(self.webpackChunkpocketframe_docs=self.webpackChunkpocketframe_docs||[]).push([[9122],{8305:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"pocketORM/entity","title":"Entities","description":"Entities in PocketORM are the core of the ORM. They represent a table in the database, and its attributes represent the columns of that table. Each entity is defined by a class that inherits from Entity. The class name is used as the table name in the database, and the attributes are used as the columns.","source":"@site/docs/pocketORM/entity.md","sourceDirName":"pocketORM","slug":"/pocketORM/entity","permalink":"/docs/docs/pocketORM/entity","draft":false,"unlisted":false,"editUrl":"https://github.com/pocketframe/docs/tree/main/docs/pocketORM/entity.md","tags":[],"version":"current","sidebarPosition":23,"frontMatter":{"sidebar_position":23},"sidebar":"tutorialSidebar","previous":{"title":"Introduction to PocketORM","permalink":"/docs/docs/pocketORM/getting-started"},"next":{"title":"Query Engine","permalink":"/docs/docs/pocketORM/query-engine"}}');var r=n(4848),i=n(8453);const a={sidebar_position:23},o="Entities",c={},d=[{value:"Defining an Entity",id:"defining-an-entity",level:2},{value:"Attributes",id:"attributes",level:3},{value:"Table Name",id:"table-name",level:3},{value:"Relationships",id:"relationships",level:3},{value:"Mass Assignment",id:"mass-assignment",level:3},{value:"Trash column",id:"trash-column",level:3},{value:"Retrieving Data",id:"retrieving-data",level:2},{value:"Building the query",id:"building-the-query",level:3},{value:"Note about DataSet",id:"note-about-dataset",level:3},{value:"Retrieving a Single Record",id:"retrieving-a-single-record",level:3},{value:"Retrieving the first category",id:"retrieving-the-first-category",level:4},{value:"Retrieving the last category",id:"retrieving-the-last-category",level:4},{value:"Retrieving a category by ID",id:"retrieving-a-category-by-id",level:4},{value:"Throwing not found exception",id:"throwing-not-found-exception",level:4},{value:"Retrieving a single record using a custom query",id:"retrieving-a-single-record-using-a-custom-query",level:4},{value:"Deep Fetch",id:"deep-fetch",level:3},{value:"Inserting Data",id:"inserting-data",level:2},{value:"Inserting a record using QueryEngine",id:"inserting-a-record-using-queryengine",level:3},{value:"Inserting Multiple Records",id:"inserting-multiple-records",level:3},{value:"Updating Data",id:"updating-data",level:2},{value:"Updating a record using an Entity",id:"updating-a-record-using-an-entity",level:3},{value:"Updating a record using QueryEngine",id:"updating-a-record-using-queryengine",level:3},{value:"Deleting Data",id:"deleting-data",level:2},{value:"Deleting a record using an Entity",id:"deleting-a-record-using-an-entity",level:3},{value:"Deleting a record using QueryEngine",id:"deleting-a-record-using-queryengine",level:3},{value:"Deleting multiple records",id:"deleting-multiple-records",level:3},{value:"Trashing a record",id:"trashing-a-record",level:3},{value:"Customizing the trash column",id:"customizing-the-trash-column",level:3},{value:"Restoring a record",id:"restoring-a-record",level:3},{value:"Entity Scopes",id:"entity-scopes",level:3}];function l(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"entities",children:"Entities"})}),"\n",(0,r.jsxs)(t.p,{children:["Entities in PocketORM are the core of the ORM. They represent a table in the database, and its attributes represent the columns of that table. Each entity is defined by a class that inherits from ",(0,r.jsx)(t.code,{children:"Entity"}),". The class name is used as the table name in the database, and the attributes are used as the columns."]}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:["An entity represents a row in a table, while a ",(0,r.jsx)(t.a,{href:"/docs/docs/pocketORM/dataset",children:"dataset"})," represents a collection of rows. You can think of an entity as a single record in the database, while a dataset is a collection of records."]})}),"\n",(0,r.jsx)(t.h2,{id:"defining-an-entity",children:"Defining an Entity"}),"\n",(0,r.jsxs)(t.p,{children:["To define an entity, you need to generate using the ",(0,r.jsx)(t.code,{children:"pocket entity:create"})," command."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"php pocket entity:create Category\n"})}),"\n",(0,r.jsxs)(t.admonition,{type:"tip",children:[(0,r.jsxs)(t.p,{children:["You can use the ",(0,r.jsx)(t.code,{children:"-s"})," option to generate a schema script for the entity, and the ",(0,r.jsx)(t.code,{children:"-b"})," option to generate a blueprint for the entity."]}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"php pocket entity:create Category -s -b\n"})}),(0,r.jsxs)(t.p,{children:["This will create a new ",(0,r.jsx)(t.code,{children:"Category"})," entity class in the ",(0,r.jsx)(t.code,{children:"app/Entities"})," directory, a schema script in the ",(0,r.jsx)(t.code,{children:"database/schema"})," directory, and a blueprint in the ",(0,r.jsx)(t.code,{children:"app/blueprints"})," directory."]})]}),"\n",(0,r.jsx)(t.admonition,{type:"danger",children:(0,r.jsxs)(t.p,{children:["The entity name must be in PascalCase (e.g., ",(0,r.jsx)(t.code,{children:"BlogTag"}),", ",(0,r.jsx)(t.code,{children:"BlogCategory"}),", etc.). The CLI will automatically convert the name to snake_case for the table name in the database."]})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\n\nnamespace App\\Entities;\n\nuse Pocketframe\\PocketORM\\Entity\\Entity;\n\nclass Category extends Entity\n{\n  //\n}\n"})}),"\n",(0,r.jsx)(t.h3,{id:"attributes",children:"Attributes"}),"\n",(0,r.jsxs)(t.p,{children:["Attributes are the properties of the entity class that represent the columns of the table. You entity class already knows the attributes of the table, but you can also define them manually if you want. To do this, you need to define an array called ",(0,r.jsx)(t.code,{children:"$attributes"})," in the entity class."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Entities;\n\nuse Pocketframe\\PocketORM\\Entity\\Entity;\n\nclass Category extends Entity\n{\n    public array $attributes = [\n      'id'\n      'name'\n      'slug'\n      'description'\n      'created_at'\n      'updated_at'\n    ];\n}\n"})}),"\n",(0,r.jsx)(t.h3,{id:"table-name",children:"Table Name"}),"\n",(0,r.jsxs)(t.p,{children:["You may notice that the entity class does not have a table name defined. This is because the entity class automatically uses the class name as the table name in snake_case and plural form. For example, the ",(0,r.jsx)(t.code,{children:"Category"})," entity will use the ",(0,r.jsx)(t.code,{children:"categories"})," table in the database. How you can override this behavior by defining a ",(0,r.jsx)(t.code,{children:"$table"})," property in the entity class."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Entities;\n\nuse Pocketframe\\PocketORM\\Entity\\Entity;\n\nclass Category extends Entity\n{\n    public string $table = 'my_categories';\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:"This will now become the table name for the entity."}),"\n",(0,r.jsx)(t.h3,{id:"relationships",children:"Relationships"}),"\n",(0,r.jsx)(t.p,{children:"PocketORM supports several types of relationships between entities. You can define these relationships in the entity class by defining a relationship property."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\n\nnamespace App\\Entities;\n\nuse Pocketframe\\PocketORM\\Concerns\\Trashable;\nuse Pocketframe\\PocketORM\\Entity\\Entity;\n\nclass Category extends Entity\n{\n\n  protected array $relationship = [\n    'posts'   => [Entity::HAS_MULTIPLE, Post::class, 'author_id'],\n  ];\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This will establish a one-to-many relationship between the ",(0,r.jsx)(t.code,{children:"Category"})," and ",(0,r.jsx)(t.code,{children:"Post"})," entities. The ",(0,r.jsx)(t.code,{children:"posts"})," property will now return all the posts that belong to the category.\nYou can also define inverse relationships using the ",(0,r.jsx)(t.code,{children:"ownedBy"})," method."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Entities;\n\nuse Pocketframe\\PocketORM\\Entity\\Entity;\n\nclass Post extends Entity\n{\n  protected array $relationship = [\n    'category' => [Entity::OWNED_BY, Category::class, 'category_id'],\n  ];\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This will establish an inverse relationship between the ",(0,r.jsx)(t.code,{children:"Post"})," and ",(0,r.jsx)(t.code,{children:"Category"})," entities. The ",(0,r.jsx)(t.code,{children:"category"})," property will now return the category that owns the post."]}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:["We will cover relationships in more detail in the ",(0,r.jsx)(t.a,{href:"/docs/docs/pocketORM/relationship",children:"Relationships"})," section."]})}),"\n",(0,r.jsx)(t.h3,{id:"mass-assignment",children:"Mass Assignment"}),"\n",(0,r.jsxs)(t.p,{children:["Mass assignment is a feature that allows you to assign multiple attributes to an entity at once. This is useful for creating or updating entities. To use mass assignment, you need to define a ",(0,r.jsx)(t.code,{children:"$fillable"})," property in the entity class."]}),"\n",(0,r.jsxs)(t.p,{children:["Mass will only allow you to submit the attributes that are defined in the ",(0,r.jsx)(t.code,{children:"$fillable"})," property. This is to prevent mass assignment of attributes that are not allowed."]}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:["This is a security feature to prevent mass assignment vulnerabilities. You should always define the ",(0,r.jsx)(t.code,{children:"$fillable"})," property in your entity class to protect against mass assignment vulnerabilities."]})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Entities;\n\nuse Pocketframe\\PocketORM\\Entity\\Entity;\n\nclass Category extends Entity\n{\n    protected array $fillable = [\n      'name',\n      'slug',\n      'description',\n    ];\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This will allow you to assign the ",(0,r.jsx)(t.code,{children:"name"}),", ",(0,r.jsx)(t.code,{children:"slug"}),", and ",(0,r.jsx)(t.code,{children:"description"})," attributes to the entity using mass assignment."]}),"\n",(0,r.jsx)(t.admonition,{type:"danger",children:(0,r.jsxs)(t.p,{children:["You should never submit data that is not defined in the ",(0,r.jsx)(t.code,{children:"$fillable"})," property. This is to prevent mass assignment vulnerabilities."]})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"$category = new Category([\n  'name'        => 'My Category',\n  'slug'        => 'my-category',\n  'description' => 'This is my category.',\n]);\n\n$category->save();\n"})}),"\n",(0,r.jsxs)(t.admonition,{type:"info",children:[(0,r.jsxs)(t.p,{children:["If you know what you are doing, you can also use the ",(0,r.jsx)(t.code,{children:"$guarded"})," property to specify which attributes should not be mass assignable. This is useful for protecting sensitive attributes from being mass assigned."]}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Entities;\nuse Pocketframe\\PocketORM\\Entity\\Entity;\n\nclass Category extends Entity\n{\n    protected array $guarded = [];\n}\n"})}),(0,r.jsx)(t.p,{children:"This will not protect you from mass assignment, but it will allow you to specify which attributes should not be mass assignable. This is useful for protecting sensitive attributes from being mass assigned."})]}),"\n",(0,r.jsx)(t.h3,{id:"trash-column",children:"Trash column"}),"\n",(0,r.jsxs)(t.p,{children:["The trash column is a special column that is used to mark an entity as deleted. This is useful for soft deletes, where the entity is not actually deleted from the database, but is marked as deleted. By default, the trash column is called ",(0,r.jsx)(t.code,{children:"trashed_at"}),", but you can override this by defining a ",(0,r.jsx)(t.code,{children:"$trashColumn"})," property in the entity class."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Entities;\n\nuse Pocketframe\\PocketORM\\Entity\\Entity;\n\nclass Category extends Entity\n{\n    protected string $trashColumn = 'deleted_status';\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This will use the ",(0,r.jsx)(t.code,{children:"deleted_status"})," column instead of the default ",(0,r.jsx)(t.code,{children:"trashed_at"})," column."]}),"\n",(0,r.jsx)(t.h2,{id:"retrieving-data",children:"Retrieving Data"}),"\n",(0,r.jsxs)(t.p,{children:["After defining an entity, you can retrieve data from the database using the ",(0,r.jsx)(t.code,{children:"QueryEngine"}),"'s ",(0,r.jsx)(t.code,{children:"for()"})," method or ",(0,r.jsx)(t.code,{children:"fromEntity"})," function. The ",(0,r.jsx)(t.code,{children:"for()"})," method is a name constructor that allows you to create a new instance of the entity class and retrieve data from the database. The ",(0,r.jsx)(t.code,{children:"fromEntity"})," function is a helper function that allows you to retrieve data from the database by passing the entity class name as a parameter."]}),"\n",(0,r.jsxs)(t.p,{children:["In these examples I will use the ",(0,r.jsx)(t.code,{children:"for()"})," method, but you can also use the ",(0,r.jsx)(t.code,{children:"fromEntity"})," . If you want to lean about the ",(0,r.jsxs)(t.a,{href:"/docs/docs/getting-deeper/helper-functions#fromentityentity",children:[(0,r.jsx)(t.code,{children:"fromEntity"})," "]}),"function, you can check the ",(0,r.jsx)(t.a,{href:"/docs/docs/getting-deeper/helper-functions#fromentityentity",children:"Helper Functions"})," section."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"\nuse App\\Entities\\Category;\nuse Pocketframe\\PocketORM\\QueryEngine\\QueryEngine;\n\n$categories = QueryEngine::for(Category::class)->get();\n\nforeach ($categories as $category) {\n    echo $category->name;\n}\n\n"})}),"\n",(0,r.jsx)(t.p,{children:"This will retrieve all the categories from the database and print their names."}),"\n",(0,r.jsx)(t.h3,{id:"building-the-query",children:"Building the query"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"get()"})," method fetches all the records from the database. In order to build complex queries, you can chain methods together. For example, you can use the ",(0,r.jsx)(t.code,{children:"where()"})," method to filter the results based on a condition."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"use App\\Entities\\Category;\nuse Pocketframe\\PocketORM\\QueryEngine\\QueryEngine;\n\n$categories = QueryEngine::for(Category::class)\n  ->whereDate('created_at', '>', '2021-01-01')\n  ->orderBy('created_at', 'desc')\n  ->limit(30)\n  ->get();\n"})}),"\n",(0,r.jsx)(t.p,{children:"This will retrieve the categories that were created after January 1st, 2021, order them by the creation date in descending order, and limit the results to 30 records."}),"\n",(0,r.jsxs)(t.admonition,{type:"tip",children:[(0,r.jsxs)(t.p,{children:["Since entities rely on the ",(0,r.jsx)(t.code,{children:"QueryEngine"})," to perform database operations, you can use any of the ",(0,r.jsx)(t.code,{children:"QueryEngine"})," methods to build your queries. This includes methods like ",(0,r.jsx)(t.code,{children:"where()"}),", ",(0,r.jsx)(t.code,{children:"orderBy()"}),", ",(0,r.jsx)(t.code,{children:"limit()"}),", and many others. You can also use the ",(0,r.jsx)(t.code,{children:"get()"})," method to retrieve the results."]}),(0,r.jsxs)(t.p,{children:["To learn more about the ",(0,r.jsx)(t.code,{children:"QueryEngine"})," and its methods, you can check the ",(0,r.jsx)(t.a,{href:"/docs/docs/pocketORM/query-engine",children:"Query Engine"})," section."]})]}),"\n",(0,r.jsx)(t.h3,{id:"note-about-dataset",children:"Note about DataSet"}),"\n",(0,r.jsxs)(t.p,{children:["As we have seen in the previous sections, the ",(0,r.jsx)(t.code,{children:"get()"})," method  fetches many records from the database. The fetched records are not just plain PHP arrays, but are actually instances of the ",(0,r.jsx)(t.code,{children:"Pocketframe\\PocketORM\\Essentials\\DataSet"})," class. This allow you to iterate over the records and access their properties using the ",(0,r.jsx)(t.code,{children:"->"})," operator."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"\nforeach ($categories as $category) {\n    echo $category->name;\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:"This will print the name of each category in the dataset."}),"\n",(0,r.jsx)(t.h3,{id:"retrieving-a-single-record",children:"Retrieving a Single Record"}),"\n",(0,r.jsxs)(t.p,{children:["In addition to retrieving multiple records, you can also retrieve a single record from the database using defined methods like ",(0,r.jsx)(t.code,{children:"first()"}),", ",(0,r.jsx)(t.code,{children:"last()"}),", or ",(0,r.jsx)(t.code,{children:"find()"}),". These methods return a single instance of the entity class instead of a dataset."]}),"\n",(0,r.jsx)(t.h4,{id:"retrieving-the-first-category",children:"Retrieving the first category"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"use App\\Entities\\Category;\nuse Pocketframe\\PocketORM\\QueryEngine\\QueryEngine;\n\n$category = QueryEngine::for(Category::class)->first();\n\necho $category->name;\n"})}),"\n",(0,r.jsx)(t.p,{children:"This will retrieve the first category from the database and print its name."}),"\n",(0,r.jsx)(t.h4,{id:"retrieving-the-last-category",children:"Retrieving the last category"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"use App\\Entities\\Category;\nuse Pocketframe\\PocketORM\\QueryEngine\\QueryEngine;\n\n$category = QueryEngine::for(Category::class)->last();\necho $category->name;\n"})}),"\n",(0,r.jsx)(t.p,{children:"This will retrieve the last category from the database and print its name."}),"\n",(0,r.jsx)(t.h4,{id:"retrieving-a-category-by-id",children:"Retrieving a category by ID"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"use App\\Entities\\Category;\nuse Pocketframe\\PocketORM\\QueryEngine\\QueryEngine;\n\n$category = QueryEngine::for(Category::class)->find(1);\necho $category->name;\n"})}),"\n",(0,r.jsx)(t.p,{children:"This will retrieve the category with ID 1 from the database and print its name."}),"\n",(0,r.jsx)(t.h4,{id:"throwing-not-found-exception",children:"Throwing not found exception"}),"\n",(0,r.jsxs)(t.p,{children:["If you want to throw an exception when the record is not found, you can use the ",(0,r.jsx)(t.code,{children:"findOrFail()"})," method. This will throw a ",(0,r.jsx)(t.code,{children:"Pocketframe\\PocketORM\\Exceptions\\EntityNotFoundException"})," if the record is not found."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"use App\\Entities\\Category;\nuse Pocketframe\\PocketORM\\QueryEngine\\QueryEngine;\n\n$category = QueryEngine::for(Category::class)->findOrFail(1);\necho $category->name;\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This will retrieve the category with ID 1 from the database and print its name. If the category is not found, a ",(0,r.jsx)(t.code,{children:"Pocketframe\\PocketORM\\Exceptions\\EntityNotFoundException"})," will be thrown."]}),"\n",(0,r.jsx)(t.h4,{id:"retrieving-a-single-record-using-a-custom-query",children:"Retrieving a single record using a custom query"}),"\n",(0,r.jsxs)(t.p,{children:["In addition to the predefined methods, you can also use the ",(0,r.jsx)(t.code,{children:"QueryEngine"})," to build custom queries and retrieve a single record from the database."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"use App\\Entities\\Category;\nuse Pocketframe\\PocketORM\\QueryEngine\\QueryEngine;\n\n$category = QueryEngine::for(Category::class)\n  ->where('name', 'My Category')\n  ->first();\necho $category->name;\n"})}),"\n",(0,r.jsx)(t.p,{children:'This will retrieve the category with the name "My Category" from the database and print its name.'}),"\n",(0,r.jsx)(t.admonition,{type:"tip",children:(0,r.jsxs)(t.p,{children:["To learn more about the ",(0,r.jsx)(t.code,{children:"QueryEngine"})," and its methods, you can check the ",(0,r.jsx)(t.a,{href:"/docs/docs/pocketORM/query-engine",children:"Query Engine"})," section."]})}),"\n",(0,r.jsx)(t.h3,{id:"deep-fetch",children:"Deep Fetch"}),"\n",(0,r.jsxs)(t.p,{children:["Do you still remember the relationships we defined in the entity class? Great! You can use them to fetch related records from the database. This is called deep fetching. You can use the ",(0,r.jsx)(t.code,{children:"include()"})," method to fetch related records. This solves the N+1 problem, where you have to make multiple queries to fetch related records."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"use App\\Entities\\Category;\nuse App\\Entities\\Post;\nuse Pocketframe\\PocketORM\\QueryEngine\\QueryEngine;\n\n$categories = QueryEngine::for(Category::class)\n  ->include('posts', function ($query) {\n      $query->where('published', true);\n  })\n  ->get();\n\nforeach ($categories as $category) {\n  echo $category->name;\n\n  foreach ($category->posts as $post) {\n      echo $post->title;\n  }\n}\n\nOutput:\n\n/*\nCategory 1\n  Post 1\n  Post 2\nCategory 2\n  Post 1\n  Post 2\n  Post 3\n*/\n"})}),"\n",(0,r.jsx)(t.p,{children:"This will retrieve all the categories from the database and print their names. For each category, it will also fetch the related posts and print their titles. This is a great way to fetch related records without making multiple queries hence solving the N+1 problem and improving performance."}),"\n",(0,r.jsx)(t.h2,{id:"inserting-data",children:"Inserting Data"}),"\n",(0,r.jsxs)(t.p,{children:["PocketORM provides many ways to insert data into the database and we will cover them in this section. You can use the ",(0,r.jsx)(t.code,{children:"save()"})," method to insert a new record into the database. The ",(0,r.jsx)(t.code,{children:"save()"})," method will automatically determine whether to insert or update the record based on whether the entity has an ID or not."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Http\\Controllers\\Web;\n\nuse App\\Entities\\Category;\n\nclass CategoryController\n{\n\n  /**\n   * Store a newly created resource in storage.\n   */\n  public function store(Request $request): Response\n  {\n    $category = new Category([\n      'category_name' => $request->post('category_name'),\n      'description'   => $request->post('description'),\n    ]);\n\n    $category->save();\n\n    return Response::redirect(route('admin.categories.index'));\n  }\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This will create a new category in the database with the name and description provided in the request. The ",(0,r.jsx)(t.code,{children:"save()"})," method will automatically insert the record into the database."]}),"\n",(0,r.jsxs)(t.p,{children:["Alternatively, you can also use this where you can just set the attributes and then call the ",(0,r.jsx)(t.code,{children:"save()"})," method to insert the record into the database."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Http\\Controllers\\Web;\n\nuse App\\Entities\\Category;\n\nclass CategoryController\n{\n\n  /**\n   * Store a newly created resource in storage.\n   */\n  public function store(Request $request): Response\n  {\n    $category = new Category();\n\n    $category->category_name = $request->post('category_name');\n    $category->description = $request->post('description');\n\n    $category->save();\n\n    return Response::redirect(route('admin.categories.index'));\n  }\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Finally, you can also use the ",(0,r.jsx)(t.code,{children:"fill()"})," method to fill the entity with data and then call the ",(0,r.jsx)(t.code,{children:"save()"})," method to insert the record into the database."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Http\\Controllers\\Web;\nuse App\\Entities\\Category;\n\nclass CategoryController\n{\n  /**\n   * Store a newly created resource in storage.\n   */\n  public function store(Request $request): Response\n  {\n    $category = new Category();\n\n    $category->fill([\n      'category_name' => $request->post('category_name'),\n      'description'   => $request->post('description'),\n    ]);\n\n    $category->save();\n\n    return Response::redirect(route('admin.categories.index'));\n  }\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This will also create a new category in the database with the name and description provided in the request. The ",(0,r.jsx)(t.code,{children:"fill()"})," method will fill the entity with the data and then the ",(0,r.jsx)(t.code,{children:"save()"})," method will insert the record into the database."]}),"\n",(0,r.jsx)(t.h3,{id:"inserting-a-record-using-queryengine",children:"Inserting a record using QueryEngine"}),"\n",(0,r.jsxs)(t.p,{children:["You can also use the ",(0,r.jsx)(t.code,{children:"QueryEngine"})," to insert a record into the database. This is useful when you want to insert a record into the database without creating an entity instance."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Http\\Controllers\\Web;\nuse App\\Entities\\Category;\nuse Pocketframe\\PocketORM\\QueryEngine\\QueryEngine;\nuse Pocketframe\\Http\\Response;\nuse Pocketframe\\Http\\Request;\n\npublic function store(Request $request): Response\n{\n  QueryEngine::for(Category::class)\n    ->insert([\n      'category_name' => $request->post('category_name'),\n      'description'   => $request->post('description'),\n    ]);\n\n  return Response::redirect(route('admin.categories.index'));\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This will insert a new category into the database with the name and description provided in the request. The ",(0,r.jsx)(t.code,{children:"insert()"})," method will automatically insert the record into the database."]}),"\n",(0,r.jsx)(t.h3,{id:"inserting-multiple-records",children:"Inserting Multiple Records"}),"\n",(0,r.jsxs)(t.p,{children:["You can also insert multiple records into the database using the ",(0,r.jsx)(t.code,{children:"insertBatch()"})," method. The ",(0,r.jsx)(t.code,{children:"insertBatch()"})," method is a method in QueryEngine which means for this case we are using QueryEngine to insert. This accepts an array of arrays, where each inner array represents a record to be inserted."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Http\\Controllers\\Web;\n\nuse App\\Entities\\Category;\nuse Pocketframe\\PocketORM\\QueryEngine\\QueryEngine;\nuse Pocketframe\\Http\\Response;\nuse Pocketframe\\Http\\Request;\n\npublic function store(Request $request): Response\n{\n  QueryEngine::for(Category::class)\n    ->insertBatch([\n      [\n        'category_name' => 'Category 1',\n        'description'   => 'This is category 1',\n      ],\n      [\n        'category_name' => 'Category 2',\n        'description'   => 'This is category 2',\n      ],\n    ]);\n\n  return Response::redirect(route('admin.categories.index'));\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This will insert two new categories into the database with the names and descriptions provided in the request. The ",(0,r.jsx)(t.code,{children:"insertBatch()"})," method will automatically insert the records into the database."]}),"\n",(0,r.jsxs)(t.admonition,{type:"warning",children:[(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"insertBatch()"})," and ",(0,r.jsx)(t.code,{children:"insert()"})," methods does not support ",(0,r.jsx)(t.a,{href:"/docs/docs/pocketORM/entity#mass-assignment",children:"mass assignment"}),", so you need to specify all the attributes for each record to be inserted. This is different from the ",(0,r.jsx)(t.code,{children:"save()"})," and ",(0,r.jsx)(t.code,{children:"fill()"})," methods, which supports mass assignment by default."]}),(0,r.jsxs)(t.p,{children:["This is because the ",(0,r.jsx)(t.code,{children:"insertBatch()"})," and ",(0,r.jsx)(t.code,{children:"insert()"})," methods are designed to be used with raw data, while the ",(0,r.jsx)(t.code,{children:"save()"})," and ",(0,r.jsx)(t.code,{children:"fill()"})," methods are designed to be used with entity instances."]}),(0,r.jsxs)(t.p,{children:["By using  ",(0,r.jsx)(t.code,{children:"insertBatch()"})," and ",(0,r.jsx)(t.code,{children:"insert()"}),", take precautions to ensure that the data being inserted is valid and sanitized to prevent SQL injection attacks."]})]}),"\n",(0,r.jsx)(t.h2,{id:"updating-data",children:"Updating Data"}),"\n",(0,r.jsx)(t.h3,{id:"updating-a-record-using-an-entity",children:"Updating a record using an Entity"}),"\n",(0,r.jsxs)(t.p,{children:["As we mentioned earlier, the ",(0,r.jsx)(t.code,{children:"save()"})," method will automatically determine whether to insert or update the record based on whether the entity has an ID or not. If the entity has an ID, it will update the record in the database. If it does not have an ID, it will insert a new record into the database."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"\n<?php\nnamespace App\\Http\\Controllers\\Web;\nuse App\\Entities\\Category;\nuse Pocketframe\\Http\\Response;\nuse Pocketframe\\Http\\Request;\n\nclass CategoryController\n{\n  /**\n   * Update the specified resource in storage.\n   */\n  public function update(Request $request, int $id): Response\n  {\n    $category = new Category([\n      'id'            => $id,\n      'category_name' => $request->post('category_name'),\n      'description'   => $request->post('description'),\n    ])\n\n    $category->save();\n\n    return Response::redirect(route('admin.categories.index'));\n  }\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This will update the category with the ID provided in the request. The ",(0,r.jsx)(t.code,{children:"save()"})," method will automatically update the record in the database."]}),"\n",(0,r.jsx)(t.h3,{id:"updating-a-record-using-queryengine",children:"Updating a record using QueryEngine"}),"\n",(0,r.jsxs)(t.p,{children:["You can also use the ",(0,r.jsx)(t.code,{children:"QueryEngine"})," to update a record in the database. This is useful when you want to update a record in the database without creating an entity instance."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"\n<?php\nnamespace App\\Http\\Controllers\\Web;\nuse App\\Entities\\Category;\nuse Pocketframe\\Http\\Response;\nuse Pocketframe\\Http\\Request;\n\nclass CategoryController\n{\n  /**\n   * Update the specified resource in storage.\n   */\n  public function update(Request $request, int $id): Response\n  {\n    QueryEngine::for(Category::class)\n      ->where('id', $id)\n      ->update([\n        'category_name' => $request->post('category_name'),\n        'description'   => $request->post('description'),\n      ]);\n\n    return Response::redirect(route('admin.categories.index'));\n  }\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This will update the category with the ID provided in the request. The ",(0,r.jsx)(t.code,{children:"update()"})," method will automatically update the record in the database."]}),"\n",(0,r.jsxs)(t.admonition,{type:"warning",children:[(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"update()"})," method does not support ",(0,r.jsx)(t.a,{href:"/docs/docs/pocketORM/entity#mass-assignment",children:"mass assignment"}),", so you need to specify all the attributes for each record to be updated. This is different from the ",(0,r.jsx)(t.code,{children:"save()"})," and ",(0,r.jsx)(t.code,{children:"fill()"})," methods, which supports mass assignment by default."]}),(0,r.jsxs)(t.p,{children:["This is because the ",(0,r.jsx)(t.code,{children:"update()"})," method is designed to be used with raw data, while the ",(0,r.jsx)(t.code,{children:"save()"})," and ",(0,r.jsx)(t.code,{children:"fill()"})," methods are designed to be used with entity instances."]}),(0,r.jsxs)(t.p,{children:["By using  ",(0,r.jsx)(t.code,{children:"update()"}),", take precautions to ensure that the data being updated is valid and sanitized to prevent SQL injection attacks."]})]}),"\n",(0,r.jsx)(t.h2,{id:"deleting-data",children:"Deleting Data"}),"\n",(0,r.jsx)(t.h3,{id:"deleting-a-record-using-an-entity",children:"Deleting a record using an Entity"}),"\n",(0,r.jsxs)(t.p,{children:["To delete a record from the database, you can use the ",(0,r.jsx)(t.code,{children:"delete()"})," method. The ",(0,r.jsx)(t.code,{children:"delete()"})," method will automatically determine whether to delete the record from the database or not based on whether the entity has an ID or not. If the entity has an ID, it will delete the record from the database. If it does not have an ID, it will not delete anything."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"\n<?php\nnamespace App\\Http\\Controllers\\Web;\n\nuse App\\Entities\\Category;\nuse Pocketframe\\Http\\Response;\nuse Pocketframe\\Http\\Request;\n\nclass CategoryController\n{\n  /**\n   * Remove the specified resource from storage.\n   */\n  public function destroy(Request $request, int $id): Response\n  {\n    $category = new Category([\n      'id' => $id\n    ]);\n\n    $category->delete();\n\n    return Response::redirect(route('admin.categories.index'));\n  }\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This will delete the category with the ID provided in the request. The ",(0,r.jsx)(t.code,{children:"delete()"})," method will automatically and permanently delete the record from the database. If you are using the ",(0,r.jsx)(t.a,{href:"/docs/docs/pocketORM/entity#trashing",children:"trashable"})," trait, the record will be trashed instead of permanently deleted."]}),"\n",(0,r.jsx)(t.h3,{id:"deleting-a-record-using-queryengine",children:"Deleting a record using QueryEngine"}),"\n",(0,r.jsxs)(t.p,{children:["You can also use the ",(0,r.jsx)(t.code,{children:"QueryEngine"})," to delete a record from the database. This is useful when you want to delete a record from the database without creating an entity instance."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Http\\Controllers\\Web;\nuse App\\Entities\\Category;\nuse Pocketframe\\Http\\Response;\nuse Pocketframe\\Http\\Request;\nuse Pocketframe\\PocketORM\\QueryEngine\\QueryEngine;\n\nclass CategoryController\n{\n  /**\n   * Remove the specified resource from storage.\n   */\n  public function destroy(Request $request, int $id): Response\n  {\n    QueryEngine::for(Category::class)\n      ->where('id', $id)\n      ->delete();\n\n    return Response::redirect(route('admin.categories.index'));\n  }\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This will delete the category with the ID provided in the request. The ",(0,r.jsx)(t.code,{children:"delete()"})," method will automatically delete the record from the database. If you are using the ",(0,r.jsx)(t.a,{href:"/docs/docs/pocketORM/entity#trashing-a-record",children:"trashable"})," trait, the record will be trashed instead of permanently deleted."]}),"\n",(0,r.jsx)(t.h3,{id:"deleting-multiple-records",children:"Deleting multiple records"}),"\n",(0,r.jsxs)(t.p,{children:["You can also delete multiple records from the database using the ",(0,r.jsx)(t.code,{children:"destroy()"})," method. The ",(0,r.jsx)(t.code,{children:"destroy()"})," method accepts an array of IDs to be deleted. The ",(0,r.jsx)(t.code,{children:"destroy()"})," method will automatically delete the records from the database."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Http\\Controllers\\Web;\nuse App\\Entities\\Category;\nuse Pocketframe\\Http\\Response;\nuse Pocketframe\\Http\\Request;\n\nclass CategoryController\n{\n  /**\n   * Remove the specified resource from storage.\n   */\n  public function destroy(Request $request, $id = null)\n  {\n      // either an array in POST\n      $ids     = $request->post('ids') ?? $id;\n      $deleted = Category::destroy($ids);\n\n      return Response::redirect(route('admin.categories.index'));\n  }\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Using the query engine, you can also delete multiple records from the database using the ",(0,r.jsx)(t.code,{children:"delete()"})," method. The ",(0,r.jsx)(t.code,{children:"delete()"})," method accepts an array of IDs to be deleted. The ",(0,r.jsx)(t.code,{children:"delete()"})," method will automatically delete the records from the database."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Http\\Controllers\\Web;\nuse App\\Entities\\Category;\nuse Pocketframe\\Http\\Response;\nuse Pocketframe\\Http\\Request;\nuse Pocketframe\\PocketORM\\QueryEngine\\QueryEngine;\n\nclass CategoryController\n{\n  /**\n   * Remove the specified resource from storage.\n   */\n  public function destroy(Request $request, $id = null)\n  {\n      // either an array in POST\n      $ids = $request->post('ids') ?? $id;\n      QueryEngine::for(Category::class)\n        ->whereIn('id', $ids)\n        ->delete();\n\n      return Response::redirect(route('admin.categories.index'));\n  }\n}\n"})}),"\n",(0,r.jsx)(t.h3,{id:"trashing-a-record",children:"Trashing a record"}),"\n",(0,r.jsxs)(t.p,{children:["You can also use the ",(0,r.jsx)(t.code,{children:"trash()"})," method to trash a record. The ",(0,r.jsx)(t.code,{children:"trash()"})," method will automatically determine whether to trash the record or not based on whether the entity has an ID or not. If the entity has an ID, it will trash the record. If it does not have an ID, it will not trash anything."]}),"\n",(0,r.jsx)(t.admonition,{type:"tip",children:(0,r.jsxs)(t.p,{children:["As we mentioned earlier, the trash column is a special column that is used to mark an entity as deleted. This is useful for trashing, where the entity is not actually deleted from the database, but is marked as deleted. By default, the trash column is called ",(0,r.jsx)(t.code,{children:"trashed_at"}),", but you can override this by defining a ",(0,r.jsx)(t.code,{children:"$trashColumn"})," property in the entity class."]})}),"\n",(0,r.jsxs)(t.p,{children:["Before you starting using the ",(0,r.jsx)(t.code,{children:"trash()"})," method, you need to make sure that the entity class uses the ",(0,r.jsx)(t.a,{href:"/docs/docs/pocketORM/entity#trashing",children:"trashable"})," trait. This will enable the trashing feature for the entity class."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\n\nnamespace App\\Entities;\n\nuse Pocketframe\\PocketORM\\Concerns\\TenantAware;\nuse Pocketframe\\PocketORM\\Concerns\\Trashable;\nuse Pocketframe\\PocketORM\\Database\\QueryEngine;\nuse Pocketframe\\PocketORM\\Entity\\Entity;\n\nclass Category extends Entity\n{\n  use Trashable;\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This will make your entity class trashable. You can now use the ",(0,r.jsx)(t.code,{children:"trash()"})," method to trash a record. In the database, the record will be marked as deleted by setting the ",(0,r.jsx)(t.code,{children:"trashed_at"})," column to the current date and time."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Http\\Controllers\\Web;\n\nuse App\\Entities\\Category;\nuse Pocketframe\\Http\\Response;\nuse Pocketframe\\Http\\Request;\nuse Pocketframe\\PocketORM\\QueryEngine\\QueryEngine;\n\nclass CategoryController\n{\n  /**\n   * Remove the specified resource from storage.\n   */\n  public function destroy(Request $request, int $id): Response\n  {\n    $category = new Category([\n      'id' => $id\n    ]);\n\n    $category->trash();\n\n    return Response::redirect(route('admin.categories.index'));\n  }\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["You can also delete a record using the ",(0,r.jsx)(t.code,{children:"QueryEngine"}),". This is useful when you want to delete a record from the database without creating an entity instance."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Http\\Controllers\\Web;\n\nuse App\\Entities\\Category;\nuse Pocketframe\\Http\\Response;\nuse Pocketframe\\Http\\Request;\nuse Pocketframe\\PocketORM\\QueryEngine\\QueryEngine;\n\nclass CategoryController\n{\n  /**\n   * Remove the specified resource from storage.\n   */\n  public function destroy(Request $request, int $id): Response\n  {\n      $category = QueryEngine::for(Category::class)\n        ->find($id);\n\n      $category->trash();\n\n    return Response::redirect(route('admin.categories.index'));\n  }\n}\n"})}),"\n",(0,r.jsx)(t.h3,{id:"customizing-the-trash-column",children:"Customizing the trash column"}),"\n",(0,r.jsxs)(t.p,{children:["You can customize the trash column by defining a ",(0,r.jsx)(t.code,{children:"$trashColumn"})," property in the entity class. This will override the default trash column name. The trash column is used to mark an entity as deleted. This is useful for trashing, where the entity is not actually deleted from the database, but is marked as deleted. Once you define a custom trash column you will need to define the ",(0,r.jsx)(t.code,{children:"trashValue"})," and ",(0,r.jsx)(t.code,{children:"restoreValue"})," properties in the entity class. The ",(0,r.jsx)(t.code,{children:"trashValue"})," property is used to mark an entity as deleted, while the ",(0,r.jsx)(t.code,{children:"restoreValue"})," property is used to mark an entity as restored."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\n\nnamespace App\\Entities;\n\nuse Pocketframe\\PocketORM\\Concerns\\TenantAware;\nuse Pocketframe\\PocketORM\\Concerns\\Trashable;\nuse Pocketframe\\PocketORM\\Database\\QueryEngine;\nuse Pocketframe\\PocketORM\\Entity\\Entity;\n\nclass Category extends Entity\n{\n  use Trashable;\n\n  protected static string $trashColumn = 'delete_status';\n  protected static $trashValue         = 'inactive';\n  protected static $restoreValue       = 'active';\n}\n"})}),"\n",(0,r.jsxs)(t.admonition,{type:"tip",children:[(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"trashValue"})," and ",(0,r.jsx)(t.code,{children:"restoreValue"})," properties are used to mark an entity as deleted or restored. You can set any values you want for these properties."]}),(0,r.jsxs)(t.p,{children:["For example, you can set the ",(0,r.jsx)(t.code,{children:"trashValue"})," to ",(0,r.jsx)(t.code,{children:"1"})," and the ",(0,r.jsx)(t.code,{children:"restoreValue"})," to ",(0,r.jsx)(t.code,{children:"0"})," if you want to use integer values for the trash column or you can set the ",(0,r.jsx)(t.code,{children:"trashValue"})," to ",(0,r.jsx)(t.code,{children:"true"})," and the ",(0,r.jsx)(t.code,{children:"restoreValue"})," to ",(0,r.jsx)(t.code,{children:"false"})," if you want to use boolean values for the trash column or you can set the ",(0,r.jsx)(t.code,{children:"trashValue"})," to ",(0,r.jsx)(t.code,{children:"active"})," and the ",(0,r.jsx)(t.code,{children:"restoreValue"})," to ",(0,r.jsx)(t.code,{children:"inactive"})," if you want to use string values for the trash column."]})]}),"\n",(0,r.jsx)(t.h3,{id:"restoring-a-record",children:"Restoring a record"}),"\n",(0,r.jsxs)(t.p,{children:["You can also use the ",(0,r.jsx)(t.code,{children:"restore()"})," method to restore a record. The ",(0,r.jsx)(t.code,{children:"restore()"})," method will automatically determine whether to restore the record or not based on whether the entity has an ID or not. If the entity has an ID, it will restore the record. If it does not have an ID, it will not restore anything."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\nnamespace App\\Http\\Controllers\\Web;\nuse App\\Entities\\Category;\nuse Pocketframe\\Http\\Response;\n\nclass CategoryController\n{\n  /**\n   * Restore the specified resource from storage.\n   */\n  public function restore(int $id): Response\n  {\n    $category = new Category([\n      'id' => $id\n    ]);\n\n    $category->restore();\n\n    return Response::redirect(route('admin.categories.index'));\n  }\n}\n"})}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:["This will also work with the custom trash column, as long as you define the ",(0,r.jsx)(t.code,{children:"restoreValue"})," property in the entity class. The ",(0,r.jsx)(t.code,{children:"restoreValue"})," property is used to mark an entity as restored."]})}),"\n",(0,r.jsx)(t.h3,{id:"entity-scopes",children:"Entity Scopes"}),"\n",(0,r.jsxs)(t.p,{children:["Entity scopes are a way to define common query constraints that can be reused across different queries.  You can define entity scopes in the entity class by defining a method with the ",(0,r.jsx)(t.code,{children:"scope"})," prefix. The method should accept a ",(0,r.jsx)(t.code,{children:"QueryEngine"})," instance and return a modified ",(0,r.jsx)(t.code,{children:"QueryEngine"})," instance."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",metastring:"showLineNumbers",children:"<?php\n\nnamespace App\\Entities;\n\nuse Pocketframe\\PocketORM\\Concerns\\Trashable;\nuse Pocketframe\\PocketORM\\Database\\QueryEngine;\nuse Pocketframe\\PocketORM\\Entity\\Entity;\n\nclass Category extends Entity\n{\n\n  public static function scopeActive(QueryEngine $query): QueryEngine\n  {\n    return $query->where('status', 'active');\n  }\n\n}\n\n// Usage\n\n  $categories = QueryEngine::for(Category::class)\n        ->scope('active')\n        ->get();\n\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This will retrieve all the active categories from the database and print their names. You can then use the ",(0,r.jsx)(t.code,{children:"scope"})," method to apply multiple scope to a query."]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>o});var s=n(6540);const r={},i=s.createContext(r);function a(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);